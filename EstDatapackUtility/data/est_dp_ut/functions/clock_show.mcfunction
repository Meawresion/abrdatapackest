#Emotion weather
summon bat ~ 355 ~ {DeathLootTable:"est_dp_ut:weather/weather",CustomName:"\"weather_detector\"",DeathTime:19}
kill @e[type=bat,name=weather_detector]
execute positioned ~ 355 ~ if entity @e[type=item,distance=..3,nbt={Item:{id:"minecraft:sea_pickle",tag:{Weather:"Clear"}}}] run scoreboard players set @s wt.out 0
execute positioned ~ 355 ~ if entity @e[type=item,distance=..3,nbt={Item:{id:"minecraft:sea_pickle",tag:{Weather:"Rain"}}}] run scoreboard players set @s wt.out 1
execute positioned ~ 355 ~ if entity @e[type=item,distance=..3,nbt={Item:{id:"minecraft:sea_pickle",tag:{Weather:"Thunder"}}}] run scoreboard players set @s wt.out 2
kill @e[type=item,nbt={Item:{id:"minecraft:sea_pickle",tag:{bd:true}}}]

# check if time needs to be calculated
execute store result score #daytime0 est.dt run time query daytime
execute unless score #daytime0 est.dt = #daytime est.dt run function est_dp_ut:calc_daytime

execute if score #hour est.dt matches 5..18 run scoreboard players set #n_time est.dt 0
execute if score #hour est.dt matches 19..23 run scoreboard players set #n_time est.dt 1
execute if score #hour est.dt matches ..4 run scoreboard players set #n_time est.dt 1

#Day & clock
execute as @a at @p[scores={wt.out=0}] if score #n_time est.dt matches 0 if score #hour est.dt matches ..9 if score #min_c est.dt matches ..9 as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"text":"0","color":"yellow"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"text":"0","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"gold"},{"text":"\u2600","color":"gold"},{"text":")","bold":true,"color":"gold"}]
execute as @a at @p[scores={wt.out=0}] if score #n_time est.dt matches 0 if score #hour est.dt matches ..9 if score #min_c est.dt matches 10.. as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"text":"0","color":"yellow"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"gold"},{"text":"\u2600","color":"gold"},{"text":")","bold":true,"color":"gold"}]
execute as @a at @p[scores={wt.out=0}] if score #n_time est.dt matches 0 if score #hour est.dt matches 10.. if score #min_c est.dt matches ..9 as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"text":"0","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"gold"},{"text":"\u2600","color":"gold"},{"text":")","bold":true,"color":"gold"}]
execute as @a at @p[scores={wt.out=0}] if score #n_time est.dt matches 0 if score #hour est.dt matches 10.. if score #min_c est.dt matches 10.. as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"gold"},{"text":"\u2600","color":"gold"},{"text":")","bold":true,"color":"gold"}]

execute as @a at @p[scores={wt.out=0}] if score #n_time est.dt matches 1 if score #hour est.dt matches ..9 if score #min_c est.dt matches ..9 as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"text":"0","color":"yellow"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"text":"0","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"gray"},{"text":"\u263d","bold":true,"color":"white"},{"text":")","bold":true,"color":"gray"}]
execute as @a at @p[scores={wt.out=0}] if score #n_time est.dt matches 1 if score #hour est.dt matches ..9 if score #min_c est.dt matches 10.. as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"text":"0","color":"yellow"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"gray"},{"text":"\u263d","bold":true,"color":"white"},{"text":")","bold":true,"color":"gray"}]
execute as @a at @p[scores={wt.out=0}] if score #n_time est.dt matches 1 if score #hour est.dt matches 10.. if score #min_c est.dt matches ..9 as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"text":"0","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"gray"},{"text":"\u263d","bold":true,"color":"white"},{"text":")","bold":true,"color":"gray"}]
execute as @a at @p[scores={wt.out=0}] if score #n_time est.dt matches 1 if score #hour est.dt matches 10.. if score #min_c est.dt matches 10.. as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"gray"},{"text":"\u263d","bold":true,"color":"white"},{"text":")","bold":true,"color":"gray"}]

#Rain
execute as @a at @p[scores={wt.out=1}] if score #hour est.dt matches ..9 if score #min_c est.dt matches ..9 as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"text":"0","color":"yellow"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"text":"0","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"aqua"},{"text":"\u2601","bold":true,"color":"dark_aqua"},{"text":")","bold":true,"color":"aqua"}]
execute as @a at @p[scores={wt.out=1}] if score #hour est.dt matches ..9 if score #min_c est.dt matches 10.. as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"text":"0","color":"yellow"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"aqua"},{"text":"\u2601","bold":true,"color":"dark_aqua"},{"text":")","bold":true,"color":"aqua"}]
execute as @a at @p[scores={wt.out=1}] if score #hour est.dt matches 10.. if score #min_c est.dt matches ..9 as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"text":"0","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"aqua"},{"text":"\u2601","bold":true,"color":"dark_aqua"},{"text":")","bold":true,"color":"aqua"}]
execute as @a at @p[scores={wt.out=1}] if score #hour est.dt matches 10.. if score #min_c est.dt matches 10.. as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"aqua"},{"text":"\u2601","bold":true,"color":"dark_aqua"},{"text":")","bold":true,"color":"aqua"}]

#Thunder
execute as @a at @p[scores={wt.out=2}] if score #hour est.dt matches ..9 if score #min_c est.dt matches ..9 as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"text":"0","color":"yellow"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"text":"0","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"dark_aqua"},{"text":"\u26a1","bold":true,"color":"yellow"},{"text":")","bold":true,"color":"dark_aqua"}]
execute as @a at @p[scores={wt.out=2}] if score #hour est.dt matches ..9 if score #min_c est.dt matches 10.. as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"text":"0","color":"yellow"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"dark_aqua"},{"text":"\u26a1","bold":true,"color":"yellow"},{"text":")","bold":true,"color":"dark_aqua"}]
execute as @a at @p[scores={wt.out=2}] if score #hour est.dt matches 10.. if score #min_c est.dt matches ..9 as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"text":"0","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"dark_aqua"},{"text":"\u26a1","bold":true,"color":"yellow"},{"text":")","bold":true,"color":"dark_aqua"}]
execute as @a at @p[scores={wt.out=2}] if score #hour est.dt matches 10.. if score #min_c est.dt matches 10.. as @p[scores={func_clo=1}] run title @s actionbar ["",{"text":"Day ","italic":true,"color":"green"},{"score":{"name":"#day","objective":"est.dt"},"italic":true,"color":"green"},{"text":" | ","color":"gray"},{"score":{"name":"#hour","objective":"est.dt"},"color":"yellow"},{"text":":","color":"yellow"},{"score":{"name":"#min_c","objective":"est.dt"},"color":"yellow"},{"text":" (","bold":true,"color":"dark_aqua"},{"text":"\u26a1","bold":true,"color":"yellow"},{"text":")","bold":true,"color":"dark_aqua"}]

#execute as @a at @p[scores={func_clo=1},nbt={SelectedItem:{id:"minecraft:clock"}}] run function est_dp_ut:raycast
#execute as @a at @p[scores={func_clo=1}] unless entity @s[nbt={SelectedItem:{id:"minecraft:clock"}}] unless entity @e[tag=dt_ray,distance=..1] as @e[tag=dt_clickdetect,distance=..5] at @s run tp @s ~ ~-1000 ~
#execute as @a at @p[scores={dt_sneak=1}] run scoreboard players set #sneakchangemode dt_sneak 1
#execute as @a at @p[scores={dt_click=1..}] if score #sneakchangemode dt_sneak matches 1 as @e[tag=dt_clickdetect,sort=nearest] at @s run say clicktest
#execute as @a at @p[scores={dt_click=1..}] if score #tick tick matches 1..10 run scoreboard players set #sneakchangemode dt_sneak 0
#execute as @a at @p[scores={dt_click=1..}] if score #tick tick matches 1..15 run scoreboard players remove @p dt_click 1


#Deactivated
execute as @a at @p[scores={func_clo=1},nbt={Inventory:[{Slot:-106b,id:"minecraft:clock"}]}] run scoreboard players set @s func_clo 0
execute as @a at @p[scores={func_clo=0},nbt={Inventory:[{Slot:-106b,id:"minecraft:clock"}]}] run tellraw @s {"text":"Show Clock Deactivated!","color":"red"}
execute as @a at @p[scores={func_clo=0},nbt={Inventory:[{Slot:-106b,id:"minecraft:clock"}]}] run playsound minecraft:entity.enderman.teleport player @s ~ ~ ~ 0.3 0.5 0.1